<h1><%= @event.name %></h1>
<p><strong>Date:</strong> <%= @event.date %></p>
<p><strong>Location:</strong> <%= @event.location %></p>
<p><strong>Description:</strong> <%= simple_format(@event.description) %></p>

<% if user_signed_in? && (current_user.admin? || @event.user == current_user) %>
  <%= link_to "Edit", edit_event_path(@event) %> |
  <%= link_to "Delete", event_path(@event), method: :delete, data: { confirm: "Are you sure?" } %> |
<% end %>
<%= link_to "Back to list", events_path %>

<hr>

<h2>Registrations</h2>
<table>
  <thead><tr><th>Name</th><th>Email</th><th>Actions</th></tr></thead>
  <tbody>
    <% @registrations.each do |reg| %>
      <tr>
        <td><%= reg.attendee_name %></td>
        <td><%= reg.attendee_email %></td>
        <td>
          <% if user_signed_in? && (current_user.admin? || @event.user == current_user) %>
            <%= link_to "Edit", edit_event_registration_path(@event, reg) %> |
            <%= link_to "Delete", event_registration_path(@event, reg), method: :delete, data: { confirm: "Delete?" } %>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<h3>Add registration</h3>
<%= form_with model: [@event, @registration], local: true do |f| %>
  <% if @registration && @registration.errors.any? %>
    <div class="errors"><%= @registration.errors.full_messages.join(", ") %></div>
  <% end %>

  <div>
    <%= f.label :attendee_name %>
    <%= f.text_field :attendee_name %>
  </div>

  <div>
    <%= f.label :attendee_email %>
    <%= f.email_field :attendee_email %>
  </div>

  <div>
    <%= f.submit "Register" %>
  </div>
<% end %>
